
######################################
# Stages
######################################
stages:
  - Compose Stage
  - Lorax Stage
  - Artifact Stage

######################################
# Compose Stage
######################################
compose-build: 
  stage: Compose Stage
  script:
    - whoami
    - mkdir secureBoot
    - cp /keys/db.key secureBoot/db.key
    - just compose photon-pony
  artifacts:
    paths:
      - "repo/"
      - "cache/"

######################################
# Lorax Stage
######################################
lorax-build:
  stage: Lorax Stage
  script:
    - sudo /usr/bin/just lorax photon-pony
  artifacts:
    paths:
      - "iso/Fedora*"
      - "iso/KS-Fedora*"
  needs:
    - compose-build
    
######################################
# Artifact Stage Stage
######################################
#artifact-build:
 # stage: Artifact Stage
  #artifacts:
   # paths:
    #  - "iso/Fedora*"
     # - "iso/KS-Fedora*"
  #needs:
   # - lorax-build




  